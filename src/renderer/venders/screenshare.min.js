/*! SkyWay Copyright(c) 2018 NTT Communications Corporation */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ScreenShare=t():e.ScreenShare=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),u=r(i),s=n(2),c=n(3),f=r(c),l=n(4),d=r(l),h=n(5),m=r(h),v=function(){function e(){o(this,e)}return a(e,null,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debug:!1},t=new u.default(e.debug);switch((0,s.getBrowserName)()){case"firefox":return new d.default(t);case"chrome":return new f.default(t);default:return new m.default(t)}}}]),e}();t.default=v,e.exports=v},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r(this,e),this._enable=t}return o(e,[{key:"log",value:function(){if(this._enable){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).log.apply(e,["SkyWay-ScreenShare: "].concat(n))}}}]),e}();t.default=a},function(e,t,n){"use strict";function r(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("firefox")?"firefox":-1!==e.indexOf("chrome")&&-1===e.indexOf("edge")?"chrome":"N/A"}Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserName=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this._logger=t,this._stream=null,this._logger.log("Chrome adapter ready")}return o(e,[{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return new Promise(function(n,r){function o(a){var i=a.data;if(t._logger.log("Received "+i.type+" message from Extension.",i),"gotStreamId"===i.type){var u=t._paramsToConstraints(e,i.streamId);t._logger.log("Parameter of getUserMedia: ",u),navigator.mediaDevices.getUserMedia(u).then(function(e){window.removeEventListener("message",o),t._stream=e,n(e)}).catch(function(e){window.removeEventListener("message",o),r(e)})}}window.addEventListener("message",o,!1),window.postMessage({type:"getStreamId"},"*")})}},{key:"stop",value:function(){this._stream instanceof MediaStream!=!1&&(this._stream.getTracks().forEach(function(e){return e.stop()}),this._stream=null)}},{key:"isScreenShareAvailable",value:function(){return"__skywayWebRTCScreenShareExtensionAvailable__"in window}},{key:"_paramsToConstraints",value:function(e,t){var n={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t},optional:[{googTemporalLayeredScreencast:!0}]},audio:!1};return isFinite(e.width)&&(n.video.mandatory.maxWidth=e.width,n.video.mandatory.minWidth=e.width),isFinite(e.height)&&(n.video.mandatory.maxHeight=e.height,n.video.mandatory.minHeight=e.height),isFinite(e.frameRate)&&(n.video.mandatory.maxFrameRate=e.frameRate,n.video.mandatory.minFrameRate=e.frameRate),n}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this._logger=t,this._stream=null,this._logger.log("Firefox adapter ready")}return o(e,[{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this._paramsToConstraints(t);return this._logger.log("Parameter of getUserMedia: ",n),navigator.mediaDevices.getUserMedia(n).then(function(t){return e._stream=t,Promise.resolve(t)})}},{key:"stop",value:function(){this._stream instanceof MediaStream!=!1&&(this._stream.getTracks().forEach(function(e){return e.stop()}),this._stream=null)}},{key:"isScreenShareAvailable",value:function(){return!0}},{key:"_paramsToConstraints",value:function(e){var t={video:{mediaSource:"window"},audio:!1};return"mediaSource"in e&&(t.video.mediaSource=e.mediaSource),isFinite(e.width)&&(t.video.width={min:e.width,max:e.width}),isFinite(e.height)&&(t.video.height={min:e.height,max:e.height}),isFinite(e.frameRate)&&(t.video.frameRate={min:e.frameRate,max:e.frameRate}),t}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this._logger=t,this._logger.log("This browser does not support screen share.")}return o(e,[{key:"start",value:function(){var e=new Error("This browser does not support screen share.");return Promise.reject(e)}},{key:"stop",value:function(){}},{key:"isScreenShareAvailable",value:function(){return!1}}]),e}();t.default=a}])});